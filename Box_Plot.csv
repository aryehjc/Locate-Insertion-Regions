import pandas as pd
import matplotlib.pyplot as plt

# Read the updated CSV file
df = pd.read_csv('updated_test.csv')

# Step 1: Identify the top 10% of frequency values
top_10_percent_threshold = df['Frequency'].quantile(0.9)
top_10_percent_df = df[df['Frequency'] >= top_10_percent_threshold]

# Step 2: Calculate GC content for the top 10% frequency values
gc_content_top_10_percent = top_10_percent_df['GC_Content'].dropna()

# Step 3: Calculate GC content for all positions
gc_content_all = df['GC_Content'].dropna()

# Plotting

# Box plot for GC content of the top 10% frequency values
plt.figure(figsize=(12, 6))
plt.boxplot(gc_content_top_10_percent, vert=False, patch_artist=True)
plt.title('GC Content for Top 10% Frequency Values')
plt.xlabel('GC Content')
plt.grid(True)
plt.show()

# Box plot for GC content across all positions
plt.figure(figsize=(12, 6))
plt.boxplot(gc_content_all, vert=False, patch_artist=True)
plt.title('GC Content Across All Positions')
plt.xlabel('GC Content')
plt.grid(True)
plt.show()
